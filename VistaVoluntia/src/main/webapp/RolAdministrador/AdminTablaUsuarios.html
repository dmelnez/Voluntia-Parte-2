<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voluntia</title>
      <link rel="icon" type="image/x-icon" href="../Imagenes/favicon.ico">
    
    <link href="/dist/output.css" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> <!-- Asegúrate de incluir jQuery aquí -->

    <script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
</head>
<style>
    #example_filter {
        display: none;
    }

    .dataTables_length {
        display: none;
    }

    .dataTables_info {
        display: none;
    }

    .dataTables_paginate {
        display: none;
    }

    #dashboard-submenu {
        z-index: 9999;
    }
</style>

<body class="bg-gray-50 dark:bg-gray-900 ">


    <div class="min-h-full">
        <nav class="bg-gray-800">
            <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
                <div class="flex h-16 items-center justify-between">
                    <div class="flex items-center">
                        <div class="shrink-0">

                        </div>
                        <div class="hidden md:block">
                            <div class="ml-10 flex items-baseline space-x-4">
                                <div>
                                    <a href="../RolAdministrador/PanelAdministrador.html"
                                        class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white">Inicio</a>
                                </div>
                                <div class="relative">
                                    <a href="#"
                                        class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white">Usuario</a>
                                    <div class="absolute left-0 hidden mt-2 space-y-1 bg-gray-800 rounded-md w-40 z-10">
                                        <a href="../RolAdministrador/AdminNuevoUsuario.jsp"
                                            class="block px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Nuevo
                                            usuario</a>
                                        <a href="../RolAdministrador/AdminTablaUsuarios.html"
                                            class="block px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Tabla
                                            usuarios</a>
                                    </div>
                                </div>
                                <div class="relative">
                                    <a href="#"
                                        class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white">Servicios</a>
                                    <div class="absolute left-0 hidden mt-2 space-y-1 bg-gray-800 rounded-md w-40 z-10">
                                        <a href="../RolAdministrador/AdminNuevoServicio.jsp"
                                            class="block px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Nuevo
                                            servicio</a>
                                        <a href="../RolAdministrador/AdminTablaServicios.html"
                                            class="block px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Tabla
                                            servicios</a>
                                    </div>
                                </div>
                                <div class="relative">
                                    <a href="#"
                                        class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white">Emergencias</a>
                                    <div class="absolute left-0 hidden mt-2 space-y-1 bg-gray-800 rounded-md w-40 z-10">
                                        <a href="../RolAdministrador/AdminNuevaEmergencia.jsp"
                                            class="block px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Nueva
                                            emergencia</a>
                                        <a href="../RolAdministrador/AdminTablaEmergencias.html"
                                            class="block px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Tabla
                                            emergencias</a>
                                    </div>
                                </div>
                                <div class="relative">
                                    <a href="#"
                                        class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white">Vehiculos</a>
                                    <div class="absolute left-0 hidden mt-2 space-y-1 bg-gray-800 rounded-md w-40 z-10">
                                        <a href="../RolAdministrador/AdminNuevoVehiculo.jsp"
                                            class="block px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Nuevo
                                            vehiculo</a>
                                        <a href="../RolAdministrador/AdminTablaVehiculos.html"
                                            class="block px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Tabla
                                            vehiculos</a>
                                    </div>
                                </div>
                                <div class="relative">
                                    <a href="#"
                                        class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white">Claves</a>
                                    <div class="absolute left-0 hidden mt-2 space-y-1 bg-gray-800 rounded-md w-40 z-10">
                                        <a href="../RolAdministrador/AdminNuevaClave.jsp"
                                            class="block px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Nueva
                                            clave</a>
                                        <a href="../RolAdministrador/AdminTablaClaves.html"
                                            class="block px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Tabla
                                            claves</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="hidden md:block">
                        <div class="ml-4 flex items-center md:ml-6">
                            <div class="relative ml-3">
                                <div>
                                    <button type="button"
                                        class="relative flex max-w-xs items-center rounded-full bg-gray-800 text-sm focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800 focus:outline-hidden"
                                        id="user-menu-button" aria-expanded="false" aria-haspopup="true">
                                        <span class="absolute -inset-1.5"></span>
                                        <span class="sr-only">Open user menu</span>
                                        <img class="size-8 rounded-full" id="imagenUsuarioPerfil"
                                            src="https://us.123rf.com/450wm/thesomeday123/thesomeday1231712/thesomeday123171200009/91087331-icono-de-perfil-de-avatar-predeterminado-para-hombre-marcador-de-posici%C3%B3n-de-foto-gris-vector-de.jpg?ver=6"
                                            alt="Imagen de Perfil del usuario">
                                    </button>
                                </div>

                                <div class="absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 ring-1 shadow-lg ring-black/5 focus:outline-hidden"
                                    role="menu" aria-orientation="vertical" aria-labelledby="user-menu-button"
                                    tabindex="-1">
                                    <a href="../RolAdministrador/AdminPerfilUsuario.jsp"
                                        class="block px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1"
                                        id="user-menu-item-0">Perfil</a>
                                    <a href="#" class="block px-4 py-2 text-sm text-gray-700" role="menuitem"
                                        tabindex="-1" id="user-menu-item-2">Cerrar</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="-mr-2 flex md:hidden">
                        <button type="button"
                            class="relative inline-flex items-center justify-center rounded-md bg-gray-800 p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800 focus:outline-hidden"
                            aria-controls="mobile-menu" aria-expanded="false">
                            <span class="absolute -inset-0.5"></span>
                            <span class="sr-only">Open main menu</span>
                            <svg class="block size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" aria-hidden="true" data-slot="icon">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                            </svg>
                            <svg class="hidden size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" aria-hidden="true" data-slot="icon">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <div class="md:hidden" id="mobile-menu">
                <div class="space-y-1 px-2 pt-2 pb-3 sm:px-3">
                    <div>
                        <a href="../RolAdministrador/PanelAdministrador.html"
                            class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white">Inicio</a>
                    </div>
                    <div class="relative">
                        <a href="#" class="block rounded-md px-3 py-2 text-base font-medium text-white"
                            aria-current="page" id="dashboard-menu">Usuarios</a>
                        <div class="absolute left-0 hidden space-y-1 mt-1 bg-gray-800 rounded-md shadow-lg p-2 z-50"
                            id="dashboard-submenu">
                            <a href="../RolAdministrador/AdminNuevoUsuario.jsp"
                                class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Nuevo
                                usuario</a>
                            <a href="../RolAdministrador/AdminTablaUsuarios.html"
                                class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Tabla
                                usuarios</a>
                        </div>

                    </div>
                    <div class="relative">
                        <a href="#" class="block rounded-md px-3 py-2 text-base font-medium text-white"
                            aria-current="page" id="dashboard-menu">Servicios</a>
                        <div class="absolute left-0 hidden space-y-1 mt-1 bg-gray-800 rounded-md shadow-lg p-2"
                            id="dashboard-submenu">
                            <a href="../RolAdministrador/AdminNuevoServicio.jsp"
                                class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Nuevo
                                servicio</a>
                            <a href="../RolAdministrador/AdminTablaServicios.html"
                                class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Tabla
                                servicios</a>
                        </div>
                    </div>
                    <div class="relative">
                        <a href="#" class="block rounded-md px-3 py-2 text-base font-medium text-white"
                            aria-current="page" id="dashboard-menu">Emergencias</a>
                        <div class="absolute left-0 hidden space-y-1 mt-1 bg-gray-800 rounded-md shadow-lg p-2"
                            id="dashboard-submenu">
                            <a href="../RolAdministrador/AdminNuevaEmergencia.jsp"
                                class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Nuevo
                                emergencias</a>
                            <a href="../RolAdministrador/AdminTablaEmergencias.html"
                                class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Tabla
                                emergencias</a>
                        </div>
                    </div>
                    <div class="relative">
                        <a href="#" class="block rounded-md px-3 py-2 text-base font-medium text-white"
                            aria-current="page" id="dashboard-menu">Vehiculos</a>
                        <div class="absolute left-0 hidden space-y-1 mt-1 bg-gray-800 rounded-md shadow-lg p-2"
                            id="dashboard-submenu">
                            <a href="../RolAdministrador/AdminNuevoVehiculo.jsp"
                                class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Nuevo
                                vehiculo</a>
                            <a href="../RolAdministrador/AdminTablaVehiculos.html"
                                class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Tabla
                                vehiculos</a>
                        </div>
                    </div>
                    <div class="relative">
                        <a href="#" class="block rounded-md px-3 py-2 text-base font-medium text-white"
                            aria-current="page" id="dashboard-menu">Claves</a>
                        <div class="absolute left-0 hidden space-y-1 mt-1 bg-gray-800 rounded-md shadow-lg p-2"
                            id="dashboard-submenu">
                            <a href="../RolAdministrador/AdminNuevaClave.jsp"
                                class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Nueva
                                clave</a>
                            <a href="../RolAdministrador/AdminTablaClaves.html"
                                class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white">Tabla
                                claves</a>
                        </div>
                    </div>
                </div>
            </div>
    </div>
    </nav>
    <header class="bg-white shadow-sm">
        <div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8 flex justify-between items-center">
            <h1 class="text-3xl font-bold tracking-tight text-gray-900">Tabla Usuarios</h1>
            <a href="../RolAdministradorEmpresa/EmpresaAdminNuevaEmergencia.jsp"
                class="inline-flex items-center px-6 py-3 text-lg font-semibold text-white bg-red-600 rounded-lg shadow-lg hover:bg-red-700 focus:outline-none focus:ring-4 focus:ring-red-400 transition">
                <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M12 8v4m0 4h.01M4.93 19h14.14a2 2 0 001.73-3L13.73 4a2 2 0 00-3.46 0L3.2 16a2 2 0 001.73 3z">
                    </path>
                </svg>
                Lanzar Emergencia
            </a>
        </div>
    </header>
    <main>
        <div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8">
            <div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8">
                <x-placeholder>
                    <div class="mx-auto w-full bg-white p-6 shadow rounded-xl">

                        <div class="flex justify-between items-center mb-4">
                            <input type="text" id="buscador" placeholder="Buscar..."
                                class="p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">

                            <div class="flex items-center gap-4">
                                <select id="filasPorPagina"
                                    class="p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    <option value="5">5 filas</option>
                                    <option value="10">10 filas</option>
                                    <option value="15">15 filas</option>
                                </select>

                                <a href="../RolAdministrador/AdminNuevoUsuario.jsp"
                                    class="flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-6 rounded-lg shadow-md transition-all duration-300">
                                    <i class="ph ph-plus-circle text-lg"></i>
                                    <span>Nuevo</span>
                                </a>
                            </div>
                        </div>

                        <table class="table-auto min-w-full rounded-xl" id="example">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="p-5 text-left whitespace-nowrap text-sm font-semibold text-gray-900">
                                        Nombre | Email </th>
                                    <th class="p-5 text-left whitespace-nowrap text-sm font-semibold text-gray-900">
                                        Indicativo </th>
                                    <th class="p-5 text-left whitespace-nowrap text-sm font-semibold text-gray-900">
                                        Rol usuario </th>
                                    <th class="p-5 text-left whitespace-nowrap text-sm font-semibold text-gray-900">
                                        Telefono </th>
                                    <th class="p-5 text-left whitespace-nowrap text-sm font-semibold text-gray-900">
                                        DNI </th>
                                    <th class="p-5 text-left whitespace-nowrap text-sm font-semibold text-gray-900">
                                        Acciones </th>
                                </tr>
                            </thead>
                            <tbody id="bodytabla" class="divide-y divide-gray-300">
                            </tbody>
                        </table>

                        <div class="flex justify-between items-center mt-4">
                            <button id="prevPage"
                                class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">Anterior</button>
                            <span id="paginaActual" class="text-gray-700"></span>
                            <button id="nextPage"
                                class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">Siguiente</button>
                        </div>
                    </div>
            </div>

        </div>



        </div>
        </div>





        <script src="https://unpkg.com/@phosphor-icons/web"></script>
        <script src="//unpkg.com/alpinejs" defer></script>
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const cerrarLink = document.getElementById('user-menu-item-2');

                cerrarLink.addEventListener('click', function (event) {
                    event.preventDefault();

                    fetch("http://localhost:8080/VistaVoluntia/usuario", {
                        method: "POST",
                        headers: { "Content-Type": "application/x-www-form-urlencoded" },
                        body: "accion=cerrar+sesion"
                    })
                        .then(response => {
                            window.location.href = "http://localhost:8080/VistaVoluntia/";
                        })
                        .catch(error => {
                            console.error("Error al cerrar sesión:", error);
                            window.location.href = "http://localhost:8080/VistaVoluntia/";
                        });
                });
            });
        </script>
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const formData = new URLSearchParams();
                formData.append("accion", "sesion");

                fetch("http://localhost:8080/VistaVoluntia/login", {
                    method: "POST",
                    credentials: "include",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                    body: formData.toString()
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.error) {
                            console.error("Error:", data.error);
                            return;
                        }
                        if (data.imagenUsuarioPerfil && data.imagenUsuarioPerfil !== "") {
                            document.getElementById("imagenUsuarioPerfil").src = "data:image/png;base64," + data.imagenUsuarioPerfil;
                        } else {
                            document.getElementById("imagenUsuarioPerfil").alt = "No se ha proporcionado una imagen de perfil.";
                        }
                    })
                    .catch(error => {
                        console.error("Error al obtener la imagen del usuario:", error);
                    });
            });
        </script>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                let tbody = document.getElementById("bodytabla");
                let filasOriginales = [];
                let filasFiltradas = [];
                let paginaActual = 1;
                let filasPorPagina = parseInt(document.getElementById("filasPorPagina").value);

                function cargarFilas() {
                    filasOriginales = Array.from(tbody.getElementsByTagName("tr"));
                    filasFiltradas = [...filasOriginales];
                    renderTabla();
                }

                function renderTabla() {
                    let totalPaginas = Math.ceil(filasFiltradas.length / filasPorPagina);
                    paginaActual = Math.min(paginaActual, totalPaginas) || 1;

                    let inicio = (paginaActual - 1) * filasPorPagina;
                    let fin = inicio + filasPorPagina;

                    tbody.innerHTML = "";
                    filasFiltradas.slice(inicio, fin).forEach(fila => tbody.appendChild(fila));

                    document.getElementById("paginaActual").innerText = `Página ${paginaActual} de ${totalPaginas || 1}`;
                    document.getElementById("prevPage").disabled = paginaActual === 1;
                    document.getElementById("nextPage").disabled = paginaActual === totalPaginas;
                }

                function cambiarPagina(nuevaPagina) {
                    let totalPaginas = Math.ceil(filasFiltradas.length / filasPorPagina);
                    if (nuevaPagina > 0 && nuevaPagina <= totalPaginas) {
                        paginaActual = nuevaPagina;
                        renderTabla();
                    }
                }

                function buscar() {
                    let filtro = document.getElementById("buscador").value.toLowerCase().trim();

                    if (filtro === "") {
                        filasFiltradas = [...filasOriginales];
                    } else {
                        filasFiltradas = filasOriginales.filter(fila => fila.innerText.toLowerCase().includes(filtro));
                    }

                    paginaActual = 1;
                    renderTabla();
                }

                document.getElementById("prevPage").addEventListener("click", () => cambiarPagina(paginaActual - 1));
                document.getElementById("nextPage").addEventListener("click", () => cambiarPagina(paginaActual + 1));
                document.getElementById("buscador").addEventListener("input", buscar);
                document.getElementById("filasPorPagina").addEventListener("change", function () {
                    filasPorPagina = parseInt(this.value);
                    paginaActual = 1;
                    renderTabla();
                });

                setTimeout(cargarFilas, 500);
            });
        </script>

        <script>
            $(document).ready(function () {
                $.ajax({
                    url: 'http://localhost:8080/VistaVoluntia/usuario?accion=listaUsuarios',
                    method: 'GET',
                    dataType: 'json',
                    success: function (data) {
                        console.log(data);

                        $('#bodytabla').empty();

                        $.each(data, function (index, usuario) {
                            if (usuario.rolUsuario != "adminEmpresa") {
                                var row = `
                        <tr>
		                    <td class="px-5 py-3">
		                        <div class="w-10 flex items-center gap-3">
		                            <img src="data:image/png;base64,${usuario.imagenPerfilUsuario}" alt="Imagen de perfil del usuario" style="width: 50px; height: 45px; border-radius: 50%; object-fit: cover;">
		                            <div class="data">
		                                <p class="font-normal text-sm text-gray-900">${usuario.nombreUsuario}</p>
		                                <p class="font-normal text-xs leading-5 text-gray-400">${usuario.correoUsuario}</p>
		                            </div>
		                        </div>
		                    </td>
		                    <td class="p-5 whitespace-nowrap text-sm leading-6 font-medium text-gray-900">${usuario.indicativoUsuario}</td>                                                                     
                            <td class="p-5 whitespace-nowrap text-sm leading-6 font-medium text-gray-900">${usuario.rolUsuario}</td>
                            <td class="p-5 whitespace-nowrap text-sm leading-6 font-medium text-gray-900">${usuario.telefonoUsuario}</td>
                            <td class="p-5 whitespace-nowrap text-sm leading-6 font-medium text-gray-900">${usuario.dniUsuario}</td>
                            <td class="flex p-5 items-center gap-0.5">
                                <button class="p-2 rounded-full bg-white group transition-all duration-500 hover:bg-indigo-600 flex item-center btn-modificar" data-usuario='${JSON.stringify(usuario)}'>
                                    <svg class="cursor-pointer" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path class="fill-indigo-500 group-hover:fill-white" d="M9.53414 8.15675L8.96459 7.59496L8.96459 7.59496L9.53414 8.15675ZM13.8911 3.73968L13.3215 3.17789V3.17789L13.8911 3.73968ZM16.3154 3.75892L15.7367 4.31126L15.7367 4.31127L16.3154 3.75892ZM16.38 3.82658L16.9587 3.27423L16.9587 3.27423L16.38 3.82658ZM16.3401 6.13595L15.7803 5.56438L16.3401 6.13595ZM11.9186 10.4658L12.4784 11.0374L11.9186 10.4658ZM11.1223 10.9017L10.9404 10.1226V10.1226L11.1223 10.9017ZM9.07259 10.9951L8.52556 11.5788L8.52556 11.5788L9.07259 10.9951ZM9.09713 8.9664L9.87963 9.1328V9.1328L9.09713 8.9664ZM9.05721 10.9803L8.49542 11.5498H8.49542L9.05721 10.9803ZM17.1679 4.99458L16.368 4.98075V4.98075L17.1679 4.99458ZM15.1107 2.8693L15.1171 2.06932L15.1107 2.8693ZM9.22851 8.51246L8.52589 8.12992L8.52452 8.13247L9.22851 8.51246ZM9.22567 8.51772L8.52168 8.13773L8.5203 8.1403L9.22567 8.51772ZM11.5684 10.7654L11.9531 11.4668L11.9536 11.4666L11.5684 10.7654ZM11.5669 10.7662L11.9507 11.4681L11.9516 11.4676L11.5669 10.7662ZM11.3235 3.30005C11.7654 3.30005 12.1235 2.94188 12.1235 2.50005C12.1235 2.05822 11.7654 1.70005 11.3235 1.70005V3.30005ZM18.3 9.55887C18.3 9.11705 17.9418 8.75887 17.5 8.75887C17.0582 8.75887 16.7 9.11705 16.7 9.55887H18.3ZM3.47631 16.5237L4.042 15.9581H4.042L3.47631 16.5237ZM16.5237 16.5237L15.958 15.9581L15.958 15.9581L16.5237 16.5237ZM10.1037 8.71855L14.4606 4.30148L13.3215 3.17789L8.96459 7.59496L10.1037 8.71855ZM15.7367 4.31127L15.8013 4.37893L16.9587 3.27423L16.8941 3.20657L15.7367 4.31127ZM15.7803 5.56438L11.3589 9.89426L12.4784 11.0374L16.8998 6.70753L15.7803 5.56438ZM10.9404 10.1226C10.3417 10.2624 9.97854 10.3452 9.72166 10.3675C9.47476 10.3888 9.53559 10.3326 9.61962 10.4113L8.52556 11.5788C8.9387 11.966 9.45086 11.9969 9.85978 11.9615C10.2587 11.9269 10.7558 11.8088 11.3042 11.6807L10.9404 10.1226ZM8.31462 8.8C8.19986 9.33969 8.09269 9.83345 8.0681 10.2293C8.04264 10.6393 8.08994 11.1499 8.49542 11.5498L9.619 10.4107C9.70348 10.494 9.65043 10.5635 9.66503 10.3285C9.6805 10.0795 9.75378 9.72461 9.87963 9.1328L8.31462 8.8ZM9.61962 10.4113C9.61941 10.4111 9.6192 10.4109 9.619 10.4107L8.49542 11.5498C8.50534 11.5596 8.51539 11.5693 8.52556 11.5788L9.61962 10.4113ZM11.1837 10.064L11.1822 10.0648L11.9516 11.4676L11.9531 11.4668L11.1837 10.064ZM16.399 6.10097L13.8984 3.60094L12.7672 4.73243L15.2677 7.23246L16.399 6.10097ZM10.8333 16.7001H9.16667V18.3001H10.8333V16.7001ZM3.3 10.8334V9.16672H1.7V10.8334H3.3ZM9.16667 3.30005H11.3235V1.70005H9.16667V3.30005ZM16.7 9.55887V10.8334H18.3V9.55887H16.7ZM9.16667 16.7001C7.5727 16.7001 6.45771 16.6984 5.61569 16.5851C4.79669 16.475 4.35674 16.2728 4.042 15.9581L2.91063 17.0894C4.5722 18.0979 5.4025 18.1709 6.15053 18.2013C6.89702 18.3017 7.84442 18.3 9.00031 18.3V16.7ZM1.7 10.8334C1.7 12.3821 1.6983 13.6241 1.82917 14.5976C1.96314 15.594 2.24905 16.4279 2.91063 17.0894L4.042 15.9581C3.72726 15.6433 3.52502 15.2034 3.41491 14.3844C3.3017 13.5423 3.3 12.4273 3.3 10.8334H1.7ZM10.8333 18.3001C12.3821 18.3001 13.6241 18.3018 14.5975 18.1709C15.5939 18.0369 16.4278 17.751 17.0894 17.0894L15.958 15.9581C15.6433 16.2728 15.2033 16.475 14.3843 16.5851C13.5423 16.6984 12.4273 16.7001 10.8333 16.7001V18.3001ZM16.7 10.8334C16.7 12.4274 16.6983 13.5423 16.5851 14.3844C16.475 15.2034 16.2727 15.6433 15.958 15.9581L17.0894 17.0894C17.7509 16.4279 18.0369 15.594 18.1708 14.5976C18.3017 13.6241 18.3 12.3821 18.3 10.8334H16.7ZM3.3 9.16672C3.3 7.57275 3.3017 6.45776 3.41491 5.61574C3.52502 4.79674 3.72726 4.35679 4.042 4.04205L2.91063 2.91068C2.24905 3.57225 1.96314 4.40612 1.82917 5.40255C1.6983 6.37596 1.7 7.61798 1.7 9.16672H3.3ZM9.16667 1.70005C7.61793 1.70005 6.37591 1.69835 5.4025 1.82922C4.40607 1.96319 3.5722 2.24911 2.91063 2.91068L4.042 4.04205C4.35674 3.72731 4.79669 3.52507 5.61569 3.41496C6.45771 3.30175 7.5727 3.30005 9.16667 3.30005V1.70005Z" fill="#818CF8"></path>
                                    </svg>
                                </button>
                                <button class="p-2 rounded-full bg-white group transition-all duration-500 hover:bg-red-600 flex items-center btn-eliminar" data-id-usuario="${usuario.idUsuario}">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path class="fill-red-600 group-hover:fill-white" d="M4.00031 5.49999V4.69999H3.20031V5.49999H4.00031ZM16.0003 5.49999H16.8003V4.69999H16.0003V5.49999ZM17.5003 5.49999L17.5003 6.29999C17.9421 6.29999 18.3003 5.94183 18.3003 5.5C18.3003 5.05817 17.9421 4.7 17.5003 4.69999L17.5003 5.49999ZM9.30029 9.24997C9.30029 8.80814 8.94212 8.44997 8.50029 8.44997C8.05847 8.44997 7.70029 8.80814 7.70029 9.24997H9.30029ZM7.70029 13.75C7.70029 14.1918 8.05847 14.55 8.50029 14.55C8.94212 14.55 9.30029 14.1918 9.30029 13.75H7.70029ZM12.3004 9.24997C12.3004 8.80814 11.9422 8.44997 11.5004 8.44997C11.0585 8.44997 10.7004 8.80814 10.7004 9.24997H12.3004ZM10.7004 13.75C10.7004 14.1918 11.0585 14.55 11.5004 14.55C11.9422 14.55 12.3004 14.1918 12.3004 13.75H10.7004ZM4.00031 6.29999H16.0003V4.69999H4.00031V6.29999ZM15.2003 5.49999V12.5H16.8003V5.49999H15.2003ZM11.0003 16.7H9.00031V18.3H11.0003V16.7ZM4.80031 12.5V5.49999H3.20031V12.5H4.80031ZM9.00031 16.7C7.79918 16.7 6.97882 16.6983 6.36373 16.6156C5.77165 16.536 5.49093 16.3948 5.29823 16.2021L4.16686 17.3334C4.70639 17.873 5.38104 18.0979 6.15053 18.2013C6.89702 18.3017 7.84442 18.3 9.00031 18.3V16.7ZM3.20031 12.5C3.20031 13.6559 3.19861 14.6033 3.29897 15.3498C3.40243 16.1193 3.62733 16.7939 4.16686 17.3334L5.29823 16.2021C5.10553 16.0094 4.96431 15.7286 4.88471 15.1366C4.80201 14.5215 4.80031 13.7011 4.80031 12.5H3.20031ZM15.2003 12.5C15.2003 13.7011 15.1986 14.5215 15.1159 15.1366C15.0363 15.7286 14.8951 16.0094 14.7024 16.2021L15.8338 17.3334C16.3733 16.7939 16.5982 16.1193 16.7016 15.3498C16.802 14.6033 16.8003 13.6559 16.8003 12.5H15.2003ZM11.0003 18.3C12.1562 18.3 13.1036 18.3017 13.8501 18.2013C14.6196 18.0979 15.2942 17.873 15.8338 17.3334L14.7024 16.2021C14.5097 16.3948 14.229 16.536 13.6369 16.6156C13.0218 16.6983 12.2014 16.7 11.0003 16.7V18.3ZM2.50031 4.69999C2.22572 4.7 2.04405 4.7 1.94475 4.7C1.89511 4.7 1.86604 4.7 1.85624 4.7C1.85471 4.7 1.85206 4.7 1.851 4.7C1.05253 5.50059 1.85233 6.3 1.85256 6.3C1.85273 6.3 1.85297 6.3 1.85327 6.3C1.85385 6.3 1.85472 6.3 1.85587 6.3C1.86047 6.3 1.86972 6.3 1.88345 6.3C1.99328 6.3 2.39045 6.3 2.9906 6.3C4.19091 6.3 6.2032 6.3 8.35279 6.3C10.5024 6.3 12.7893 6.3 14.5387 6.3C15.4135 6.3 16.1539 6.3 16.6756 6.3C16.9364 6.3 17.1426 6.29999 17.2836 6.29999C17.3541 6.29999 17.4083 6.29999 17.4448 6.29999C17.4631 6.29999 17.477 6.29999 17.4863 6.29999C17.4909 6.29999 17.4944 6.29999 17.4968 6.29999C17.498 6.29999 17.4988 6.29999 17.4994 6.29999C17.4997 6.29999 17.4999 6.29999 17.5001 6.29999C17.5002 6.29999 17.5003 6.29999 17.5003 5.49999C17.5003 4.69999 17.5002 4.69999 17.5001 4.69999C17.4999 4.69999 17.4997 4.69999 17.4994 4.69999C17.4988 4.69999 17.498 4.69999 17.4968 4.69999C17.4944 4.69999 17.4909 4.69999 17.4863 4.69999C17.477 4.69999 17.4631 4.69999 17.4448 4.69999C17.4083 4.69999 17.3541 4.69999 17.2836 4.69999C17.1426 4.7 16.9364 4.7 16.6756 4.7C16.1539 4.7 15.4135 4.7 14.5387 4.7C12.7893 4.7 10.5024 4.7 8.35279 4.7C6.2032 4.7 4.19091 4.7 2.9906 4.7C2.39044 4.7 1.99329 4.7 1.88347 4.7C1.86974 4.7 1.86051 4.7 1.85594 4.7C1.8548 4.7 1.85396 4.7 1.85342 4.7C1.85315 4.7 1.85298 4.7 1.85288 4.7C1.85284 4.7 2.65253 5.49941 1.85408 6.3C1.85314 6.3 1.85296 6.3 1.85632 6.3C1.86608 6.3 1.89511 6.3 1.94477 6.3C2.04406 6.3 2.22573 6.3 2.50031 6.29999L2.50031 4.69999ZM7.05028 5.49994V4.16661H5.45028V5.49994H7.05028ZM7.91695 3.29994H12.0836V1.69994H7.91695V3.29994ZM12.9503 4.16661V5.49994H14.5503V4.16661H12.9503ZM12.0836 3.29994C12.5623 3.29994 12.9503 3.68796 12.9503 4.16661H14.5503C14.5503 2.8043 13.4459 1.69994 12.0836 1.69994V3.29994ZM7.05028 4.16661C7.05028 3.68796 7.4383 3.29994 7.91695 3.29994V1.69994C6.55465 1.69994 5.45028 2.8043 5.45028 4.16661H7.05028ZM2.50031 6.29999C4.70481 6.29998 6.40335 6.29998 8.1253 6.29997C9.84725 6.29996 11.5458 6.29995 13.7503 6.29994L13.7503 4.69994C11.5458 4.69995 9.84724 4.69996 8.12529 4.69997C6.40335 4.69998 4.7048 4.69998 2.50031 4.69999L2.50031 6.29999ZM13.7503 6.29994L17.5003 6.29999L17.5003 4.69999L13.7503 4.69994L13.7503 6.29994ZM7.70029 9.24997V13.75H9.30029V9.24997H7.70029ZM10.7004 9.24997V13.75H12.3004V9.24997H10.7004Z" fill="#F87171"></path>
                                    </svg>
                                </button>
                            </td>
                        </tr>`;
                                $('#bodytabla').append(row);
                            }
                        });

                        $('#example').DataTable();

                        $(document).on('click', '.btn-modificar', function () {
                            var usuario = $(this).data('usuario');
                            sessionStorage.setItem('usuarioModificar', JSON.stringify(usuario));
                            window.location.href = "AdminModificarUsuario.jsp";
                        });
                    },
                    error: function (xhr, status, error) {
                        console.error('Error en la solicitud AJAX:', error);
                    }
                });
            });


        </script>


        <script>
            $(document).on('click', '.btn-eliminar', function () {
                var idUsuario = $(this).data('id-usuario');

                Swal.fire({
                    title: 'Confirmación de eliminación',
                    text: "¿Estás seguro de que deseas eliminar este usuario? Esta acción no se puede deshacer.",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Sí, eliminarlo',
                    cancelButtonText: 'Cancelar'
                }).then((result) => {
                    if (result.isConfirmed) {
                        $.ajax({
                            url: 'http://localhost:8080/VistaVoluntia/usuario',
                            method: 'POST',
                            data: { accion: 'eliminar', idUsuario: idUsuario },
                            success: function (response) {
                                Swal.fire({
                                    title: 'Eliminado',
                                    text: 'El usuario ha sido eliminado correctamente.',
                                    icon: 'success',
                                    confirmButtonText: 'Aceptar'
                                }).then(() => {
                                    location.reload();
                                });
                            },
                            error: function (xhr, status, error) {
                                Swal.fire({
                                    title: 'Error',
                                    text: 'Hubo un error al eliminar el usuario: ' + error,
                                    icon: 'error',
                                    confirmButtonText: 'Aceptar'
                                });
                            }
                        });
                    }
                });
            });
        </script>


        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const cerrarLink = document.getElementById('user-menu-item-2');

                cerrarLink.addEventListener('click', function (event) {
                    event.preventDefault();

                    fetch("http://localhost:8080/VistaVoluntia/usuario", {
                        method: "POST",
                        headers: { "Content-Type": "application/x-www-form-urlencoded" },
                        body: "accion=cerrar+sesion"
                    })
                        .then(response => {
                            window.location.href = "http://localhost:8080/VistaVoluntia/";
                        })
                        .catch(error => {
                            console.error("Error al cerrar sesión:", error);
                            window.location.href = "http://localhost:8080/VistaVoluntia/";
                        });
                });
            });
        </script>


        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const userMenuButton = document.getElementById('user-menu-button');
                const userMenu = document.querySelector('[aria-labelledby="user-menu-button"]');
                const mobileMenuButton = document.querySelector('[aria-controls="mobile-menu"]');
                const mobileMenu = document.getElementById('mobile-menu');

                if (userMenuButton && userMenu) {
                    userMenu.classList.add('hidden');
                    userMenuButton.setAttribute('aria-expanded', 'false');

                    userMenuButton.addEventListener('click', () => {
                        const isExpanded = userMenuButton.getAttribute('aria-expanded') === 'true';
                        userMenuButton.setAttribute('aria-expanded', !isExpanded);
                        userMenu.classList.toggle('hidden');
                    });

                    document.addEventListener('click', (event) => {
                        if (!userMenu.contains(event.target) && !userMenuButton.contains(event.target)) {
                            userMenu.classList.add('hidden');
                            userMenuButton.setAttribute('aria-expanded', 'false');
                        }
                    });
                }

                if (mobileMenuButton && mobileMenu) {
                    mobileMenu.classList.add('hidden');
                    mobileMenuButton.setAttribute('aria-expanded', 'false');

                    mobileMenuButton.addEventListener('click', () => {
                        const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
                        mobileMenuButton.setAttribute('aria-expanded', !isExpanded);
                        mobileMenu.classList.toggle('hidden');
                    });
                }

                const menuOptions = document.querySelectorAll('.relative');
                menuOptions.forEach(option => {
                    const subMenu = option.querySelector('.absolute');
                    let timeout;

                    option.addEventListener('mouseenter', () => {
                        clearTimeout(timeout);
                        subMenu.classList.remove('hidden');
                    });

                    option.addEventListener('mouseleave', (event) => {
                        if (!subMenu.contains(event.relatedTarget)) {
                            timeout = setTimeout(() => {
                                subMenu.classList.add('hidden');
                            }, 100);
                        }
                    });

                    subMenu.addEventListener('mouseenter', () => {
                        clearTimeout(timeout);
                        subMenu.classList.remove('hidden');
                    });

                    subMenu.addEventListener('mouseleave', (event) => {
                        if (!option.contains(event.relatedTarget)) {
                            timeout = setTimeout(() => {
                                subMenu.classList.add('hidden');
                            }, 200);
                        }
                    });

                    option.addEventListener('click', (event) => {
                        const isExpanded = subMenu.classList.contains('hidden');
                        subMenu.classList.toggle('hidden', !isExpanded);
                    });
                });

                const menuItems = document.querySelectorAll('.ml-10 a');
                menuItems.forEach(item => {
                    item.addEventListener('click', (event) => {
                        menuItems.forEach(link => link.classList.remove('bg-gray-900', 'text-white'));
                        item.classList.add('bg-gray-900', 'text-white');
                    });
                });

                document.addEventListener('click', (event) => {
                    const subMenus = document.querySelectorAll('.absolute');
                    subMenus.forEach(subMenu => {
                        if (!subMenu.contains(event.target) && !event.target.closest('.relative')) {
                            subMenu.classList.add('hidden');
                        }
                    });
                });
            });


        </script>




</body>

</html>